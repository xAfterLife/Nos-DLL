#pragma once
#include <cstdio>
#include <Windows.h>
#include <string>

#define PacketLogger DB752C198646481993E1AEDD0FF0D303
#define FindAddresses DE94E71FB6FB47069FBB4B55DCE42AAA
#define HookSend E1B018A6DC8F4789BB71655B8927254D
#define HookRecv F9A2B36B35E3426A925BA3D387D42DBB
#define UnhookSend E0B93FE62F034A80B48AAB6725DA9101
#define UnhookRecv D3E4ED637C224EDDA3239384835E5A2B
#define CustomSend AE9D3DD94A894E1691A717998EB7847D
#define CustomRecv E99CBD21B7584FE29BA4576A3E0B18A6
#define CustomSendLog BD14A6EA2FDB423FAB96D13A1FAB763E
#define CustomRecvLog A4071FE66EE24BB98994C0F4DB467D89
#define StartLogger BD145661B7634E57847970E953C5F130
#define StopLogger BEDD1565FC98474882A0B389F486D867
#define SendPacket A7979B4A7E8E4645B32DFDB6CAB95990
#define ReceivePacket BC135ADE4223455381EB66F6BE047A14
#define AddPrint E80B97AD0E7646F4A2ED09E296E92A99
#define RemovePrint D4B3249B453C4A53813598E918D547F0

class DB752C198646481993E1AEDD0FF0D303
{
	BOOL printToConsole_ = false;
	FILE* freOut_ = nullptr;

	const BYTE sendPattern_[25] = {0x53, 0x56, 0x8B, 0xF2, 0x8B, 0xD8, 0xEB, 0x04, 0xEB, 0x05, 0x39, 0x19, 0x8B, 0xD6, 0x8B, 0xC3, 0xE8, 0xFF, 0xFF, 0xFF, 0xFF, 0x84, 0xC0, 0x74, 0x1A};
	const BYTE recvPattern_[22] = {0x55, 0x8B, 0xEC, 0x83, 0xC4, 0xF4, 0x53, 0x56, 0x57, 0x33, 0xC9, 0x89, 0x4D, 0xF4, 0x89, 0x55, 0xFC, 0x8B, 0xD8, 0x8B, 0x45, 0xFC};
	const BYTE packetThisPattern_[23] = {0xA1, 0x00, 0x00, 0x00, 0x00, 0x8B, 0x00, 0xE8, 0x00, 0x00, 0x00, 0x00, 0xA1, 0x00, 0x00, 0x00, 0x00, 0x8B, 0x00, 0x33, 0xD2, 0x89, 0x10};

	LPCSTR sendMask_ = "xxxxxxxxxxxxxxxxx????xxxx";
	LPCSTR recvMask_ = "xxxxx?xxxxxxxxxxxxxxxx";
	LPCSTR packetThisMask_ = "x????xxx????x????xxxxxx";

	BOOL DE94E71FB6FB47069FBB4B55DCE42AAA ();
	BOOL E1B018A6DC8F4789BB71655B8927254D () const;
	BOOL F9A2B36B35E3426A925BA3D387D42DBB () const;
	BOOL E0B93FE62F034A80B48AAB6725DA9101 () const;
	BOOL D3E4ED637C224EDDA3239384835E5A2B () const;

	static void AE9D3DD94A894E1691A717998EB7847D ();
	static void E99CBD21B7584FE29BA4576A3E0B18A6 ();

	static void BD14A6EA2FDB423FAB96D13A1FAB763E ();
	static void A4071FE66EE24BB98994C0F4DB467D89 ();

public:
	DB752C198646481993E1AEDD0FF0D303 ();
	explicit DB752C198646481993E1AEDD0FF0D303 (BOOL logger);

	BOOL BD145661B7634E57847970E953C5F130 ();
	BOOL BEDD1565FC98474882A0B389F486D867 () const;
	void A7979B4A7E8E4645B32DFDB6CAB95990 (char const* szPacket);
	void BC135ADE4223455381EB66F6BE047A14 (char const* szPacket);

	void E80B97AD0E7646F4A2ED09E296E92A99 ();
	void D4B3249B453C4A53813598E918D547F0 ();
};
